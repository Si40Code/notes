{{- define "main" -}}
<main class="container article-wrapper">
  <article class="post-detail">
    {{- $coverParam := .Params.cover -}}
    {{- $coverSrc := "" -}}
    {{- if $coverParam -}}
      {{- $coverResource := false -}}
      {{- if not (hasPrefix (printf "%v" $coverParam) "http") -}}
        {{- $coverResource = .Resources.GetMatch (printf "%v" $coverParam) -}}
      {{- end -}}
      {{- if $coverResource -}}
        {{- $coverSrc = $coverResource.RelPermalink -}}
      {{- else -}}
        {{- $coverSrc = (printf "%v" $coverParam) -}}
      {{- end -}}
    {{- end -}}
    {{- $coverAlt := default .Title (.Params.cover_alt | default .Params.coverAlt) -}}
    {{- $coverCaption := .Params.cover_caption | default .Params.coverCaption -}}
    {{- if $coverSrc -}}
    <figure class="post-cover">
      <img src="{{ $coverSrc | absURL }}" alt="{{ $coverAlt }}" loading="lazy" decoding="async">
      {{- with $coverCaption }}
      <figcaption>{{ . }}</figcaption>
      {{- end }}
    </figure>
    {{- end -}}
    <h1>{{ .Title }}</h1>
    <div class="post-meta">
      {{- with .Date -}}
      <time datetime="{{ .Format "2006-01-02" }}">{{ .Format "2006-01-02" }}</time>
      {{- end -}}
      {{- $minutes := .ReadingTime -}}
      <span>·</span>
      <span>{{ cond (lt $minutes 2) "约 1 分钟读完" (printf "%d 分钟读完" $minutes) }}</span>
      {{- with .Params.tags -}}
      {{ range . }}
      <span class="tag-chip">#{{ . }}</span>
      {{ end }}
      {{- end -}}
    </div>
    {{- if .TableOfContents -}}
    <aside class="table-of-contents">
      <h2>目录</h2>
      {{ .TableOfContents }}
    </aside>
    {{- end -}}
    <div class="content">
      {{ .Content }}
    </div>
  </article>
</main>
{{- end -}}
